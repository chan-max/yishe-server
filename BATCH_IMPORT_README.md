# 爬虫素材批量入库到贴纸功能

## 功能概述

本功能实现了将爬虫素材批量转换为贴纸的功能，支持单个和批量操作。**入库成功后会自动删除对应的爬虫素材数据**。

## 实现的功能

### 后端功能

1. **批量入库接口**
   - 接口路径：`POST /crawler/material/import-to-sticker`
   - 功能：将选中的爬虫素材批量转换为贴纸
   - 参数：
     - `ids`: 爬虫素材ID数组
     - `uploaderId`: 上传者ID（可选）

2. **服务层实现**
   - 在 `CrawlerService` 中添加了 `batchImportToSticker` 方法
   - 支持批量处理，包含成功和失败的结果统计
   - 自动映射爬虫素材字段到贴纸字段
   - **入库成功后自动删除对应的爬虫素材**

3. **模块依赖**
   - 在 `CrawlerModule` 中导入了 `StickerModule`
   - 注入了 `StickerService` 用于创建贴纸

### 前端功能

1. **批量入库按钮**
   - 在爬虫素材列表页面添加了"批量入库"按钮
   - 显示选中的素材数量
   - 支持加载状态显示

2. **单个入库功能**
   - 在每行的操作菜单中添加了"入库"选项
   - 支持单个素材的快速入库

3. **用户交互**
   - 确认对话框，防止误操作
   - 成功/失败消息提示
   - 自动刷新列表数据

## 字段映射

| 爬虫素材字段 | 贴纸字段 | 说明 |
|-------------|---------|------|
| name | name | 素材名称 |
| description | description | 描述信息 |
| keywords | keywords | 关键词 |
| url | url | 图片URL |
| suffix | suffix | 文件后缀 |
| uploaderId | uploaderId | 上传者ID |
| source | meta.originalSource | 来源信息 |
| id | meta.originalId | 原始素材ID |

## 使用方式

### 批量入库
1. 在爬虫素材列表页面选择要入库的素材
2. 点击"批量入库"按钮
3. 确认操作
4. 查看入库结果
5. **入库成功的素材会自动从爬虫素材列表中删除**

### 单个入库
1. 在素材行的操作菜单中选择"入库"
2. 确认操作
3. 查看入库结果
4. **入库成功的素材会自动从爬虫素材列表中删除**

## 技术实现

### 后端技术栈
- NestJS
- TypeORM
- 依赖注入

### 前端技术栈
- Vue 3
- Element Plus
- VXE Table
- Pinia (状态管理)

## 注意事项

1. 入库后的贴纸默认设置为非公开状态
2. 贴纸分组设置为"爬虫素材"
3. 原始素材信息保存在贴纸的meta字段中
4. 支持批量处理，包含错误处理机制
5. **入库成功后会自动删除对应的爬虫素材数据**
6. 如果入库失败，爬虫素材数据会保留，不会删除 